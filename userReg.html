<!DOCTYPE html>
<html lang="en">
     <head>
        <title>Xi New User Self-Registration</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <link rel="stylesheet" href="vendor/css/example.wink.css" />
        <link rel="stylesheet" href="../xi3/css/style.css" />
        <link rel="stylesheet" href="css/login.css" />

        <script src="vendor/js/jquery-2.2.0.js"></script>
        <script src="vendor/js/hideShowPassword.js"></script>
        <script src="vendor/js/spin.js"></script>
         <script src="https://www.google.com/recaptcha/api.js"></script>
         <script src="./js/forms.js"></script>
     </head>
    
     <body>
         
        <header>
            <h1>Xi New User Self-Registration</h1>
        </header>

        <div class="login">

              <form id="register_form" name="register_form" method="post" action="./php/registerNewUser.php" class="login-form">
                  
                <div class="control-group">
                    <label for="email">Pick Username</label>
                    <input type="text" value="" placeholder="Username" id="username" name="username" pattern="^[a-zA-Z0-9-_.]{4,16}" oninput="this.setCustomValidity('')" oninvalid="this.setCustomValidity('Between 4 and 16 Alphanumeric characters only please')" required/>
                    <span class="error">&lt; Between 4 and 16 Alphanumeric characters only please</span>
                    <span class="error2"></span>
                </div>
                  
                <div class="control-group">
                    <label for="email">Email Address</label>
                    <input type="email" value="" placeholder="email@address" id="email" name="email" pattern="" required/>
                    <span class="error">&lt; Hotmail/Yahoo/Gmail addresses not supported</span>
                    <span class="error2"></span>
                </div>

                <div class="control-group">
                    <label for="pass1">Password</label>
                    <input type="password" value="" placeholder="Password" id="pass" name="pass" pattern=".{6,}" oninput="this.setCustomValidity('')" oninvalid="this.setCustomValidity('At least 6 characters required')" required/>
                    <span class="error">&lt; At least 6 characters required</span>
                    <input type="checkbox" id="show-password">
                    <label for="show-password">Show password</label>
                </div>
                  
                <div class="g-recaptcha" id="recaptchaWidget" data-sitekey="getFromConfig.json"></div>
                <span class="error">&lt; Please check the captcha form</span>
                <br/>
                  
                <input name="Submit" value="Register" type="submit" class="btn btn-1a"/>

              </form>
            
            <div id="spinBox"></div>
            <div id="msg"></div>

            <script type="text/javascript"> 
                $(document).ready(function(e) {
                    $.getJSON("./json/config.json", function (config) {
                        
                        $("#recaptchaWidget").attr("data-sitekey", config.googleRecaptchaPublicKey);
                        var splitRegex = config.emailRegex.split("/");
                        $("#email").attr("pattern", splitRegex[1]);
                        
                        var spinner = new Spinner ({
                            lines: 13, // The number of lines to draw
                            length: 5, // The length of each line
                            width: 2, // The line thickness
                            radius: 7, // The radius of the inner circle
                        });

                        // Example 3:
                        // - When checkbox changes, toggle password
                        //   visibility based on its 'checked' property
                        $('#show-password').change(function(){
                          $('#pass').hideShowPassword($(this).prop('checked'));
                        });


                        // divert form submit action to this javascript function
                        $("#register_form").submit (function(e) {
                            $(".error2").css("display", "none");
                            spinner.spin (document.getElementById ("spinBox"));
                            CLMSUI.loginForms.ajaxPost (e.target, {"g-recaptcha-response": grecaptcha.getResponse()}, function() { spinner.stop(); });
                            e.preventDefault();
                        });
                    });
                });
            </script>
        </div>

        <footer>
            <p></p>
        </footer>

    </body>
</html>